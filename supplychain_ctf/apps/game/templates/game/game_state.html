{% extends "game/parent.html" %}
{% load mathfilters %}
{% block content %}
    <div class="row" style="margin-top: 10px; border: 1px solid black">
        <div class="col s1"></div>
        <div class="col s4"><h4>Score: {{ game_state.score }}</h4> </div>
        <div class="col s4"><h4>Days left: {{ game_state.days_left }}</h4> </div>
        <div class="col s1">
        </div>
        <div class="col s2" style="padding-top: 10px">
            <a class="waves-effect waves-light btn-large" >
                <i class="material-icons right">watch_later</i>Next Turn
            </a>
        </div>

    </div>
   <div class="row">
      <div class="col s3" style="border: 1px solid black">Events</div>
       <div class="col s9" style="border: 1px solid black">
           <h4 style="text-align: center">Systems</h4>
           <br/>
           {% for systemstate in game_state.systemstate_set.all %}
                 <div class="card">

                    <div class="card-content">
                        <span class="card-title activator grey-text text-darken-4">
                            <!-- system status -->
                            {% if systemstate.procured %}
                                {% if systemstate.downtime > 0 %}
                                    <span class="new badge red" data-badge-caption=" turns downtime">{{ systemstate.downtime }}</span>
                                {% endif %}
                            {% endif %}
                            <!-- /system status -->
                            {{ systemstate.system.name }}
                            <span style="float:right" >
                                +{{ systemstate.system.score_per_day }} / turn
                            </span>
                        </span>

                      <p>{{ systemstate.system.description }}</p>
                    </div>
                    <div class="card-tabs">
                      <ul class="tabs tabs-fixed-width">
                          {% for vendor in systemstate.system.vendors.all %}
                              <li class="tab  {% if systemstate.procured and systemstate.chosen_vendor != vendor%}disabled{% endif %}">
                                  <a {% if systemstate.procured and systemstate.chosen_vendor == vendor%}
                                      class="active"

                                  {% endif %}
                                      href="#{{ systemstate.pk }}vendor{{ vendor.pk }}">{{ vendor.name }}</a>
                              </li>
                          {% endfor %}
                      </ul>
                    </div>
                    <div class="card-content grey lighten-4">
                        {% for vendor in systemstate.system.vendors.all %}
                            <div id="{{ systemstate.pk }}vendor{{ vendor.pk }}">
                            {% if not systemstate.procured %}
                            <a class="btn-floating halfway-fab waves-effect waves-light green"
                                        href="{% url 'procure_systemstate' systemstate_id=systemstate.pk vendor_id=vendor.pk %}"
                            >
                                <i class="material-icons">attach_money</i>
                            </a>
                            {% endif %}
                                {{ vendor.description }}

                            <div style="margin-top: 2px">
                              {% for tag in vendor.tags.all %}
                                  {% if tag.visible %}
                                      <div class="chip">
                                         {{ tag.tag_name }}
                                      </div>
                                  {% endif %}
                              {% endfor %}
                            </div>
                            <div style="position: absolute; right:100px; bottom: 0px;">
                                Downtime: {{vendor.downtime_cost_multiplier|mul:systemstate.system.downtime_cost}} turns <br />
                                Cost: {{vendor.setup_cost_multiplier|mul:systemstate.system.setup_cost}} score <br/>
                            </div>
                            <div></div>
                            </div>
                        {% endfor %}
                    </div>
                  </div>
           {% endfor %}
       </div>
   </div>
{% endblock %}